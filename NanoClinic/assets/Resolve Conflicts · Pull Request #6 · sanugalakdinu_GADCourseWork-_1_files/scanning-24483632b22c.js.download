"use strict";(()=>{var W=Object.defineProperty;var i=(h,x)=>W(h,"name",{value:x,configurable:!0});(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[9858],{36108:(h,x,u)=>{u.d(x,{ZG:()=>C,q6:()=>L,w4:()=>I});var m=u(22593);let w=!1;const A=new m.Z;function S(p){const f=p.target;if(f instanceof HTMLElement&&f.nodeType!==Node.DOCUMENT_NODE)for(const E of A.matches(f))E.data.call(null,f)}i(S,"handleFocus");function C(p,f){w||(w=!0,document.addEventListener("focus",S,!0)),A.add(p,f),document.activeElement instanceof HTMLElement&&document.activeElement.matches(p)&&f(document.activeElement)}i(C,"onFocus");function I(p,f,E){function y(g){const j=g.currentTarget;!j||(j.removeEventListener(p,E),j.removeEventListener("blur",y))}i(y,"blurHandler"),C(f,function(g){g.addEventListener(p,E),g.addEventListener("blur",y)})}i(I,"onKey");function L(p,f){function E(y){const{currentTarget:g}=y;!g||(g.removeEventListener("input",f),g.removeEventListener("blur",E))}i(E,"blurHandler"),C(p,function(y){y.addEventListener("input",f),y.addEventListener("blur",E)})}i(L,"onInput")},97683:(h,x,u)=>{u.d(x,{r:()=>m});function m(w,A){const S=w.createElement("template");return S.innerHTML=A,w.importNode(S.content,!0)}i(m,"parseHTML")},10935:(h,x,u)=>{var m=u(11427);function w(e){const t=document.createElement("input");return t.setAttribute("type","hidden"),t.setAttribute("name",e.name),t.setAttribute("value",e.value),t}i(w,"copyInput");function A(e){let t=!1;const n=e.querySelectorAll(".js-scanning-fixed-alert-numbers"),o=n.length!==0?JSON.parse(n[0].getAttribute("data-numbers")||"[]"):[];for(const s of e.querySelectorAll(".js-scanning-bulk-action-items")){s.innerHTML="";const r=e.querySelectorAll(".js-scanning-alert-list [data-check-all-item]:checked");for(const c of r)t||(t=o.indexOf(parseInt(c.value))!==-1),s.appendChild(w(c))}for(const s of e.querySelectorAll(".js-scanning-reopen-button"))s.hidden=t;for(const s of e.querySelectorAll(".js-scanning-reopen-button-disabled"))s.hidden=!t}i(A,"copyCheckedAlertsToBulkActionForms"),(0,m.on)("change",".js-scanning-alert-check",function({currentTarget:e}){const t=e.closest(".js-scanning-alert-list"),n=t.querySelector(".js-scanning-alert-check:checked")!=null,o=t.querySelector(".js-scanning-filter-options"),s=t.querySelector(".js-scanning-alert-bulk-actions"),r=t.querySelector(".js-scanning-alert-links");o&&(o.hidden=n),s&&(s.hidden=!n),r&&(r.hidden=n),A(t)}),(0,m.on)("details-menu-selected",".js-scanning-code-path-menu",function(e){const t=e.detail.relatedTarget.getAttribute("data-target-code-path");for(const n of document.querySelectorAll(".js-scanning-code-path"))n.hidden=t!==n.getAttribute("data-code-path")},{capture:!0});var S=u(36108),C=u(89390),I=u(56153),L=u(30762),p=u(97683);(0,L.N7)(".js-add-secret-format-button",{add(){window.postProcessingExpressionCount=0;const e=document.querySelector(".js-post-processing-expression-count");e&&e.textContent&&(window.postProcessingExpressionCount=parseInt(e.textContent))}}),(0,m.on)("click",".js-add-secret-format-button",e=>{const t=e.currentTarget;if(!!t&&window.postProcessingExpressionCount<N()){const n=document.querySelectorAll(".js-additional-secret-format");if(!n)return;for(const o of n)if(o.classList.contains("has-removed-contents")){o.classList.toggle("has-removed-contents",!1),window.postProcessingExpressionCount++,window.postProcessingExpressionCount===N()&&(t.hidden=!0);break}}}),(0,m.on)("click",".js-remove-secret-format-button",e=>{var t,n;const o=document.querySelector(".js-add-secret-format-button");if(!o)return;const s=e.currentTarget;if(!s)return;const r=s.closest(".js-additional-secret-format");if(!r)return;r.classList.toggle("has-removed-contents",!0);const c=r.getElementsByClassName("js-post-processing-input")[0];c.value="";const l=Array.from(r.getElementsByClassName("js-post-processing-input-rule")),d=r.getElementsByClassName("errored")[0];d&&d.classList.toggle("errored",!1);for(const a of l)(t=document.getElementById(`${a.id}_hidden`))==null||t.remove();(n=document.getElementById(`${c.id}_hidden`))==null||n.remove(),j(window.codeEditor.getValue()),window.postProcessingExpressionCount--,window.postProcessingExpressionCount<N()&&(o.hidden=!1)}),(0,L.N7)(".js-test-code",{async add(){const e=document.querySelector(".js-test-code"),t=e.clientHeight,n=await u.e(7509).then(u.t.bind(u,27509,23));if(window.codeEditor=n.default.fromTextArea(e,{lineNumbers:!1,lineWrapping:!0,mode:"text/x-yaml",inputStyle:"contenteditable",value:e.value,lineSeparator:`\r
`,theme:"github-light"}),t!==0){const o=document.querySelector(".CodeMirror");o&&(o.style.height=`${t}px`,o.style.border="1px solid #e1e4e8",o.style.borderRadius="6px")}window.codeEditor.save(),window.codeEditor.on("change",()=>{j(window.codeEditor.getValue())})}}),(0,S.q6)(".js-custom-secret-scanning-pattern-form *",async function(){!window.codeEditor||j(window.codeEditor.getValue())}),(0,m.on)("click",".js-repo-selector-dialog-summary-button.disabled",e=>{e.preventDefault()}),(0,m.on)("click",".js-save-and-dry-run-button, .js-custom-pattern-submit-button, .js-org-repo-selector-dialog-dry-run-button",e=>{e.preventDefault();const t=f(e);if(!t)return;E(t);const n=y();!n||((t.className.includes("js-save-and-dry-run-button")||t.className.includes("js-org-repo-selector-dialog-dry-run-button"))&&g(n,"submit_type","save_and_dry_run"),(0,m.f)(n,"submit"))});function f(e){return e.currentTarget}i(f,"getSubmitButton");function E(e){e.innerHTML=e.getAttribute("data-disable-with")||"",e.disabled=!0}i(E,"setSubmitButtonDisableWith");function y(){return document.querySelector(".js-custom-secret-scanning-pattern-form")}i(y,"getCustomPatternForm");const g=i((e,t,n)=>{const o=document.createElement("input");o.type="hidden",o.name=t,o.id=`${t}_hidden`,o.value=n,e.appendChild(o),o.required=!0},"createHiddenInputField"),j=(0,I.D)(function(e){const t=document.querySelector(".js-custom-pattern-submit-button"),n=document.querySelector(".js-save-and-dry-run-button"),o=document.querySelector(".js-repo-selector-dialog-summary-button"),s=document.querySelector(".js-update-pattern-info"),r=document.querySelector(".js-test-pattern-matches");if(!!r)if(e.length===0){const c=document.querySelector(".js-dry-run-status");if(!c)return;$(c)||t==null||t.setAttribute("disabled","true"),n==null||n.setAttribute("disabled","true"),o==null||o.classList.add("disabled"),r.textContent=""}else{window.codeEditor.save();const c=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(c instanceof HTMLFormElement))return;const l=y();if(!l)return;for(const d of l.elements)if(d instanceof HTMLInputElement&&d.name&&(d.type==="text"||d.type==="radio"&&d.checked)){const a=document.getElementById(`${d.name}_hidden`);a!==null&&a.remove(),g(c,d.name,d.value)}z(c,P(l,t,n,o,s),R(r))}},300),R=i(e=>t=>{if(t.length===0)e.textContent=" - No matches";else if(t.length===1)e.textContent=" - 1 match";else{const n=[];for(const r of t)n.push(JSON.stringify(r));const s=[...new Set(n)];e.textContent=` - ${s.length} matches`}},"getTestLabelUpdater"),P=i((e,t,n,o,s)=>r=>{var c,l,d;if(O(e),r==null?void 0:r.message){if(t==null||t.setAttribute("disabled","true"),n==null||n.setAttribute("disabled","true"),o==null||o.classList.add("disabled"),s)s.hidden=!0;else if((r==null?void 0:r.error_type)==="START_DELIMITER"||(r==null?void 0:r.error_type)==="END_DELIMITER"||(r==null?void 0:r.error_type)==="MUST_MATCH"||(r==null?void 0:r.error_type)==="MUST_NOT_MATCH"){const a=document.querySelector(".js-more-options.js-details-container");a&&(a.classList.add("open"),a.classList.add("Details--on"))}return B(e,r),!1}else{const a=document.querySelector(".js-mode");if(!a)return!1;const v=document.querySelector(".js-dry-run-status");return v?((((c=v.textContent)==null?void 0:c.toLowerCase())==="cancelled"||((l=v.textContent)==null?void 0:l.toLowerCase())==="skipped"||((d=a.textContent)==null?void 0:d.toLowerCase())!=="unpublished")&&(t==null||t.removeAttribute("disabled")),o==null||o.classList.remove("disabled"),n==null||n.removeAttribute("disabled"),s&&(s.hidden=!1),!0):!1}},"getTestErrorHandler");function B(e,t){var n;if(t.error_type==="MUST_MATCH"||t.error_type==="MUST_NOT_MATCH"){let o=0;const s=e.getElementsByClassName("js-additional-secret-format");for(const r of s){if(o>(t.error_index||0))return;const l=[...r.getElementsByTagName("input")].filter(T=>T.checked),d=l&&((n=l[0])==null?void 0:n.value.toUpperCase()),a=d===t.error_type&&o===t.error_index,k=[...r.getElementsByTagName("input")].filter(T=>T.type==="text");if(!k||k.length===0)continue;const b=k[0];if(b.value!=="")if(a){const T=b.id;b&&b.parentElement&&M(b.parentElement);const _=document.createElement("p"),F=`${T}_error_message`;_.classList.add("note","error","mt-5"),_.id=F,_.textContent=t.message,b==null||b.setAttribute("aria-describedby",F),b==null||b.insertAdjacentElement("afterend",_);return}else d===t.error_type&&o++}}else{const o=U[t.error_type],s=document.querySelector(`#${o}`);s&&s.parentElement&&M(s.parentElement);const r=document.createElement("p"),c=`${o}_error_message`;r.classList.add("note","error"),r.id=c,r.textContent=t.message,s==null||s.setAttribute("aria-describedby",c),s==null||s.insertAdjacentElement("afterend",r)}}i(B,"showInputErrorState");function O(e){var t,n;const o=document.querySelector(".js-error-banner");o.hidden=!0;for(const s of e.getElementsByTagName("input"))if((t=s.parentElement)==null?void 0:t.classList.contains("errored")){H(s.parentElement);const r=s.getAttribute("aria-describedby");(n=document.querySelector(`#${r}`))==null||n.remove()}}i(O,"clearInputErrorState");function N(){const e=document.querySelector(".js-post-processing-expression-max-count");if(!e)return 5;const t=e.textContent;return t?parseInt(t):5}i(N,"getMaxPostProcessingExpressions");function M(e){e==null||e.classList.add("form-group","errored","my-0")}i(M,"addErrorStylingToInput");function H(e){e==null||e.classList.remove("form-group","errored","my-0")}i(H,"removeErrorStylingFromInput");function D(){if(!window.codeEditor)return;const e=window.codeEditor.posFromIndex(0),t=window.codeEditor.posFromIndex(window.codeEditor.getValue().length);for(const n of window.codeEditor.findMarks(e,t))n.clear()}i(D,"clearCodeHighlights");function $(e){var t,n;return((t=e.textContent)==null?void 0:t.toLowerCase())==="queued"||((n=e.textContent)==null?void 0:n.toLowerCase())==="inprogress"}i($,"allowDryRunCancellation");const U={NONE:"",CONFIG_LOAD:"secret_format",COMPILE_DB:"secret_format",START_DELIMITER:"before_secret",END_DELIMITER:"after_secret",DISPLAY_NAME:"display_name"};async function z(e,t,n){let o;try{const s=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{Accept:"application/json"}});s.ok&&(o=await s.json())}catch{}if(o&&t(o.error))if(o.has_matches){const s=JSON.parse(o.matches);D(),n(s);for(const r of s){const c=window.codeEditor.posFromIndex(r.start),l=window.codeEditor.posFromIndex(r.end);window.codeEditor.markText(c,l,{className:"text-bold hx_keyword-hl rounded-2 d-inline-block"})}}else n([]),D()}i(z,"updatePatternMatches");async function J(e){const t=e.currentTarget;e.preventDefault(),q(t,parseInt(t.remove_repo_id.value),!1)}i(J,"removeDryRunRepo");async function q(e,t,n){const o=document.getElementById("selected_repo_ids");if(!o)return;const s=document.querySelector(".js-org-repo-selector-dialog-dry-run-button");if(!s)return;const r=JSON.parse(o.value),c=new Set(r);n?c.size<V()&&c.add(t):c.delete(t),o.value=JSON.stringify(Array.from(c)),c.size>0?s.removeAttribute("disabled"):s.setAttribute("disabled","true");const l=new FormData(e);l.append("selected_repo_ids",o.value);const d=await fetch(e.action,{method:e.method,body:l,headers:{Accept:"text/fragment+html"}});if(d.status>=400){const a="An unknown error occurred.",v=document.querySelector("template.js-flash-template");v.after(new C.R(v,{className:"flash-error",message:a}))}else{const a=document.querySelector(".js-dry-run-selected-repos"),v=(0,p.r)(document,await d.text());a.replaceWith(v)}}i(q,"updateDryRunSelectedRepos"),(0,m.on)("click",".js-remove-dry-run-repo-form",J),(0,m.on)("auto-complete-change",".js-dry-run-repo-autocomplete",function(e){const t=e.target;if(!t.value)return;const n=t.closest("form");q(n,parseInt(n.repo_id.value),!0),t.value=""}),(0,S.w4)("keydown",".js-dry-run-repo-autocomplete-input",function(e){e.key==="Enter"&&e.preventDefault()});function V(){const e=document.querySelector(".js-dry-run-selected-repos-max-count");if(!e)return 10;const t=e.textContent;return t?parseInt(t):10}i(V,"getMaxDryRunSelectedRepos")}},h=>{var x=i(m=>h(h.s=m),"__webpack_exec__");h.O(0,[762,6427],()=>x(10935));var u=h.O()}]);})();

//# sourceMappingURL=scanning-73e835cc3f19.js.map